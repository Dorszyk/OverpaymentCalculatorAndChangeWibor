<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pl"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AmountsCalculationService.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">OverpaymentCalculatorAndChangeWibor</a> &gt; <a href="index.source.html" class="el_package">pl.inbank.overpayment.services</a> &gt; <span class="el_source">AmountsCalculationService.java</span></div><h1>AmountsCalculationService.java</h1><pre class="source lang-java linenums">package pl.inbank.overpayment.services;

import pl.inbank.overpayment.model.InputData;
import pl.inbank.overpayment.model.Installment;
import pl.inbank.overpayment.model.InstallmentAmounts;
import pl.inbank.overpayment.model.Overpayment;

import java.math.BigDecimal;
import java.math.MathContext;
import java.math.RoundingMode;
import java.time.LocalDate;
import java.time.temporal.ChronoUnit;

public interface AmountsCalculationService {

<span class="fc" id="L16">    BigDecimal YEAR = BigDecimal.valueOf(12);</span>

    InstallmentAmounts calculate(final InputData inputData, final Overpayment overpayment);

    InstallmentAmounts calculate(final InputData inputData, final Overpayment overpayment, final BigDecimal monthlyCommission, final Installment previousInstallment);

    public static BigDecimal calculateInterestAmount(
            final BigDecimal principalAmount,
            final BigDecimal annualInterestRate,
            final LocalDate startPaymentDate, // Data rozpoczÄ™cia okresu dla obliczeĹ„ odsetek
            final LocalDate nextPaymentDate) { // Data nastÄ™pnej pĹ‚atnoĹ›ci

        // Oblicz liczby dni miÄ™dzy datami
<span class="nc" id="L29">        long daysBetween = ChronoUnit.DAYS.between(startPaymentDate, nextPaymentDate);</span>

        // Ustawienie liczby dni w roku na staĹ‚Ä… wartoĹ›Ä‡ 360 dla 'bank year'
<span class="nc" id="L32">        BigDecimal daysInBankYear = BigDecimal.valueOf(360);</span>

        // Oblicz dziennÄ… stopÄ™ procentowÄ…
<span class="nc" id="L35">        BigDecimal dailyInterestRate = annualInterestRate.divide(daysInBankYear, MathContext.DECIMAL128);</span>

        // Oblicz kwotÄ™ odsetek za okres miÄ™dzy pĹ‚atnoĹ›ciami
<span class="nc" id="L38">        BigDecimal interestAmountForPeriod = principalAmount</span>
<span class="nc" id="L39">                .multiply(dailyInterestRate)</span>
<span class="nc" id="L40">                .multiply(BigDecimal.valueOf(daysBetween));</span>

<span class="nc" id="L42">        return interestAmountForPeriod.setScale(2, RoundingMode.HALF_EVEN);</span>
    }




    static BigDecimal calculateQ(final BigDecimal interestPercent) {
<span class="nc" id="L49">        return interestPercent.divide(AmountsCalculationService.YEAR, 10, RoundingMode.HALF_UP).add(BigDecimal.ONE);</span>
    }

    static BigDecimal compareCapitalWithResidual(final BigDecimal capitalAmount, final BigDecimal residualAmount) {
<span class="nc bnc" id="L53" title="All 2 branches missed.">        if (capitalAmount.compareTo(residualAmount) &gt;= 0) {</span>
<span class="nc" id="L54">            return residualAmount;</span>
        }
<span class="nc" id="L56">        return capitalAmount;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>